---
stages:
  - build
  - validate
  - release

.setup:
  script:
    - !reference [.opensearch, script]

.build:
  services:
    - !reference [.opensearch, services]
  variables:
    MAVEN_EXTRA_ARGS: '-Dinteg.http.eshost=opensearch'

trigger_api:
  extends: .trigger_down_stream
  variables: {}
  trigger:
    project: npo/api
    branch: master


trigger_npo_publish:
  extends: .trigger_down_stream
  variables: {}
  trigger:
    project: npo/npo-publish
    branch: master

trigger_pages_publish:
  extends: .trigger_down_stream
  variables: {}
  trigger:
    project: npo/pages-publish
    branch: master


include:
  - project: 'shared/gitlab/gitlab-templates'
    ref: 'master'
    file: 'maven_release.yml'
